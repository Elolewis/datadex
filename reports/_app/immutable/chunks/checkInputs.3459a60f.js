import{S as B,i as N,s as Q,e as g,u as A,a as z,b as k,d as b,v as I,h,f as O,j as d,k as D,l as y,B as S,w as re,ac as le,y as q,o as oe,p as T,q as se,t as w,ad as ae,H as j,I as L,J as V,K as M,c as ue,g as fe,m as ce,r as de,T as J,_ as P,a7 as G,n as _e,a8 as me,A as U,x as W,U as X,V as Y,G as Z}from"./index.f13c6880.js";import{f as K}from"./index.634eda69.js";import{c as he,d as pe,e as ye,Q as be}from"./VennDiagram.svelte_svelte_type_style_lang.e9eed537.js";import{t as ve,a as ge,l as ke}from"./formatting.0f9c3f12.js";function we(r){let e,t,n,o,s,i;return{c(){e=g("div"),t=g("span"),n=A("Loading..."),o=z(),s=g("div"),this.h()},l(l){e=k(l,"DIV",{class:!0});var a=b(e);t=k(a,"SPAN",{class:!0});var c=b(t);n=I(c,"Loading..."),c.forEach(h),o=O(a),s=k(a,"DIV",{class:!0}),b(s).forEach(h),a.forEach(h),this.h()},h(){d(t,"class","sr-only"),d(s,"class","h-full w-full bg-gray-200 rounded-md dark:bg-gray-400"),d(e,"class","animate-pulse h-full w-full my-2")},m(l,a){D(l,e,a),y(e,t),y(t,n),y(e,o),y(e,s)},p:S,i(l){l&&(i||re(()=>{i=le(e,K,{}),i.start()}))},o:S,d(l){l&&h(e)}}}class Te extends B{constructor(e){super(),N(this,e,null,we,Q,{})}}const Ee=r=>({loaded:r&2}),x=r=>({loaded:r[1]}),De=r=>({loaded:r&1}),$=r=>({loaded:r[0]}),Se=r=>({loaded:r&1}),ee=r=>({loaded:r[0]}),Ce=r=>({loaded:r&1}),te=r=>({loaded:r[0]});function Ae(r){let e;const t=r[4].default,n=j(t,r,r[3],x);return{c(){n&&n.c()},l(o){n&&n.l(o)},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s&10)&&L(n,t,o,o[3],e?M(t,o[3],s,Ee):V(o[3]),x)},i(o){e||(w(n,o),e=!0)},o(o){T(n,o),e=!1},d(o){n&&n.d(o)}}}function Ie(r){let e;const t=r[4].error,n=j(t,r,r[3],$);return{c(){n&&n.c()},l(o){n&&n.l(o)},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s&9)&&L(n,t,o,o[3],e?M(t,o[3],s,De):V(o[3]),$)},i(o){e||(w(n,o),e=!0)},o(o){T(n,o),e=!1},d(o){n&&n.d(o)}}}function je(r){let e;const t=r[4].skeleton,n=j(t,r,r[3],ee),o=n||Ve();return{c(){o&&o.c()},l(s){o&&o.l(s)},m(s,i){o&&o.m(s,i),e=!0},p(s,i){n&&n.p&&(!e||i&9)&&L(n,t,s,s[3],e?M(t,s[3],i,Se):V(s[3]),ee)},i(s){e||(w(o,s),e=!0)},o(s){T(o,s),e=!1},d(s){o&&o.d(s)}}}function Le(r){let e;const t=r[4].default,n=j(t,r,r[3],te);return{c(){n&&n.c()},l(o){n&&n.l(o)},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s&9)&&L(n,t,o,o[3],e?M(t,o[3],s,Ce):V(o[3]),te)},i(o){e||(w(n,o),e=!0)},o(o){T(n,o),e=!1},d(o){n&&n.d(o)}}}function Ve(r){let e,t,n;return t=new Te({}),{c(){e=g("div"),ue(t.$$.fragment),this.h()},l(o){e=k(o,"DIV",{class:!0});var s=b(e);fe(t.$$.fragment,s),s.forEach(h),this.h()},h(){d(e,"class","w-full h-64")},m(o,s){D(o,e,s),ce(t,e,null),n=!0},p:S,i(o){n||(w(t.$$.fragment,o),n=!0)},o(o){T(t.$$.fragment,o),n=!1},d(o){o&&h(e),de(t)}}}function Me(r){let e,t,n,o;const s=[Le,je,Ie,Ae],i=[];function l(a,c){var u,f;return!a[0]||!((u=a[0])!=null&&u.__isQueryStore)?0:!a[1]||!((f=a[1])!=null&&f.loaded)&&!a[1].error?1:a[1].error?2:3}return e=l(r),t=i[e]=s[e](r),{c(){t.c(),n=q()},l(a){t.l(a),n=q()},m(a,c){i[e].m(a,c),D(a,n,c),o=!0},p(a,[c]){let u=e;e=l(a),e===u?i[e].p(a,c):(oe(),T(i[u],1,1,()=>{i[u]=null}),se(),t=i[e],t?t.p(a,c):(t=i[e]=s[e](a),t.c()),w(t,1),t.m(n.parentNode,n))},i(a){o||(w(t),o=!0)},o(a){T(t),o=!1},d(a){i[e].d(a),a&&h(n)}}}function ze(r,e,t){let{$$slots:n={},$$scope:o}=e,{data:s}=e,i=()=>{},l;return ae(i),r.$$set=a=>{"data"in a&&t(0,s=a.data),"$$scope"in a&&t(3,o=a.$$scope)},r.$$.update=()=>{r.$$.dirty&5&&s!=null&&s.__isQueryStore&&(s.fetch(),i(),t(2,i=s.subscribe(a=>{t(1,l=a)})))},[s,l,i,o,n]}class st extends B{constructor(e){super(),N(this,e,ze,Me,Q,{data:0})}}function ne(r){let e,t,n,o,s,i,l,a,c,u;const f=r[7].default,_=j(f,r,r[6],null),m=_||Oe();return{c(){e=g("div"),t=g("button"),n=g("span"),o=A(r[1]),s=z(),m&&m.c(),this.h()},l(p){e=k(p,"DIV",{});var v=b(e);t=k(v,"BUTTON",{type:!0,"aria-label":!0,class:!0});var E=b(t);n=k(E,"SPAN",{});var H=b(n);o=I(H,r[1]),H.forEach(h),s=O(E),m&&m.l(E),E.forEach(h),v.forEach(h),this.h()},h(){d(t,"type","button"),d(t,"aria-label",r[1]),d(t,"class",i=G(r[4].class)+" svelte-p80uux")},m(p,v){D(p,e,v),y(e,t),y(t,n),y(n,o),y(t,s),m&&m.m(t,null),a=!0,c||(u=_e(t,"click",function(){me(r[3](r[0]))&&r[3](r[0]).apply(this,arguments)}),c=!0)},p(p,v){r=p,(!a||v&2)&&U(o,r[1]),_&&_.p&&(!a||v&64)&&L(_,f,r,r[6],a?M(f,r[6],v,null):V(r[6]),null),(!a||v&2)&&d(t,"aria-label",r[1]),(!a||v&16&&i!==(i=G(r[4].class)+" svelte-p80uux"))&&d(t,"class",i)},i(p){a||(w(m,p),p&&re(()=>{l||(l=W(e,K,{duration:200},!0)),l.run(1)}),a=!0)},o(p){T(m,p),p&&(l||(l=W(e,K,{duration:200},!1)),l.run(0)),a=!1},d(p){p&&h(e),m&&m.d(p),p&&l&&l.end(),c=!1,u()}}}function Oe(r){let e,t;return{c(){e=X("svg"),t=X("path"),this.h()},l(n){e=Y(n,"svg",{width:!0,height:!0,viewBox:!0,fill:!0,"stroke-width":!0,"stroke-linecap":!0,"stroke-linejoin":!0});var o=b(e);t=Y(o,"path",{d:!0}),b(t).forEach(h),o.forEach(h),this.h()},h(){d(t,"d","M3 15v4c0 1.1.9 2 2 2h14a2 2 0 0 0 2-2v-4M17 9l-5 5-5-5M12 12.8V2.5"),d(e,"width","12"),d(e,"height","12"),d(e,"viewBox","0 0 24 24"),d(e,"fill","none"),d(e,"stroke-width","2"),d(e,"stroke-linecap","round"),d(e,"stroke-linejoin","round")},m(n,o){D(n,e,o),y(e,t)},p:S,d(n){n&&h(e)}}}function qe(r){let e,t,n=r[2]&&ne(r);return{c(){n&&n.c(),e=q()},l(o){n&&n.l(o),e=q()},m(o,s){n&&n.m(o,s),D(o,e,s),t=!0},p(o,[s]){o[2]?n?(n.p(o,s),s&4&&w(n,1)):(n=ne(o),n.c(),w(n,1),n.m(e.parentNode,e)):n&&(oe(),T(n,1,1,()=>{n=null}),se())},i(o){t||(w(n),t=!0)},o(o){T(n),t=!1},d(o){n&&n.d(o),o&&h(e)}}}function Be(r,e,t){let{$$slots:n={},$$scope:o}=e,{data:s}=e,{queryID:i}=e,{text:l="Download"}=e,{display:a}=e,{downloadData:c=u=>{const f={fieldSeparator:",",quoteStrings:'"',decimalSeparator:".",showLabels:!0,showTitle:!1,filename:i??"evidence_download",useTextFile:!1,useBom:!0,useKeysAsHeaders:!0},_=JSON.parse(JSON.stringify(Array.from(u)));new he.ExportToCsv(f).generateCsv(_)}}=e;return r.$$set=u=>{t(4,e=J(J({},e),P(u))),"data"in u&&t(0,s=u.data),"queryID"in u&&t(5,i=u.queryID),"text"in u&&t(1,l=u.text),"display"in u&&t(2,a=u.display),"downloadData"in u&&t(3,c=u.downloadData),"$$scope"in u&&t(6,o=u.$$scope)},e=P(e),[s,l,a,c,e,i,o,n]}class it extends B{constructor(e){super(),N(this,e,Be,qe,Q,{data:0,queryID:5,text:1,display:2,downloadData:3})}}function Ne(r,e){let t;return r?r._evidenceColumnTypes?r._evidenceColumnTypes.find(o=>{var s;return((s=o.name)==null?void 0:s.toLowerCase())===(e==null?void 0:e.toLowerCase())}):(Array.isArray(r)&&r.length>0?t=r[0]:t=r,t&&t._evidenceColumnTypes?t._evidenceColumnTypes.find(o=>{var s;return((s=o.name)==null?void 0:s.toLowerCase())===(e==null?void 0:e.toLowerCase())}):pe(r).find(o=>{var s;return((s=o.name)==null?void 0:s.toLowerCase())===(e==null?void 0:e.toLowerCase())})):null}function Qe(r,e){return r<e?-1:r>e?1:r>=e?0:NaN}function*Ue(r,e){if(e===void 0)for(let t of r)t!=null&&(t=+t)>=t&&(yield t);else{let t=-1;for(let n of r)(n=e(n,++t,r))!=null&&(n=+n)>=n&&(yield n)}}function F(r,e){let t;if(e===void 0)for(const n of r)n!=null&&(t<n||t===void 0&&n>=n)&&(t=n);else{let n=-1;for(let o of r)(o=e(o,++n,r))!=null&&(t<o||t===void 0&&o>=o)&&(t=o)}return t}function R(r,e){let t;if(e===void 0)for(const n of r)n!=null&&(t>n||t===void 0&&n>=n)&&(t=n);else{let n=-1;for(let o of r)(o=e(o,++n,r))!=null&&(t>o||t===void 0&&o>=o)&&(t=o)}return t}function ie(r,e,t=0,n=r.length-1,o=Qe){for(;n>t;){if(n-t>600){const a=n-t+1,c=e-t+1,u=Math.log(a),f=.5*Math.exp(2*u/3),_=.5*Math.sqrt(u*f*(a-f)/a)*(c-a/2<0?-1:1),m=Math.max(t,Math.floor(e-c*f/a+_)),p=Math.min(n,Math.floor(e+(a-c)*f/a+_));ie(r,e,m,p,o)}const s=r[e];let i=t,l=n;for(C(r,t,e),o(r[n],s)>0&&C(r,t,n);i<l;){for(C(r,i,l),++i,--l;o(r[i],s)<0;)++i;for(;o(r[l],s)>0;)--l}o(r[t],s)===0?C(r,t,l):(++l,C(r,l,n)),l<=e&&(t=l+1),e<=l&&(n=l-1)}return r}function C(r,e,t){const n=r[e];r[e]=r[t],r[t]=n}function Ke(r,e,t){if(r=Float64Array.from(Ue(r,t)),!!(n=r.length)){if((e=+e)<=0||n<2)return R(r);if(e>=1)return F(r);var n,o=(n-1)*e,s=Math.floor(o),i=F(ie(r,s).subarray(0,s+1)),l=R(r.subarray(s+1));return i+(l-i)*(o-s)}}function Fe(r,e){return Ke(r,.5,e)}function Re(r,e){return n=>{e=e??{};const o={},s=Object.keys(r);for(const i of s)o[i]=r[i](n);if(e.rest&&n.length){const i=Object.keys(n[0]);for(const l of i)s.includes(l)||(o[l]=e.rest(l)(n))}return[o]}}function He(r,e,t,n){if(!r.length)return[];const o={};let s;if(n==null)s=Object.keys(r[0]);else{s=[];for(const i of ye(n))typeof i=="function"?s.push(...i(r)):s.push(i)}for(const i of s){if(t){const l=r.map(a=>a[i]);if(!t(l))continue}o[i]=e(i)(r)}return[o]}function lt(r,e){return n=>He(n,e,void 0,r)}function Je(r){const e=typeof r=="function"?r:t=>t[r];return t=>R(t,e)}function Pe(r){const e=typeof r=="function"?r:t=>t[r];return t=>F(t,e)}function Ge(r){const e=typeof r=="function"?r:t=>t[r];return t=>Fe(t,e)}function We(r,e){const t=ve(r,Re({min:Je(e),max:Pe(e),median:Ge(e)}))[0],{maxDecimals:n,unitType:o}=Xe(r.map(s=>s[e]));return{min:t.min,max:t.max,median:t.median,maxDecimals:n,unitType:o}}function Xe(r){var e;if(r==null||r.length===0)return{maxDecimals:0,unitType:"unknown"};{let t=0;for(const n of r){const o=(e=n==null?void 0:n.toString().split(".")[1])==null?void 0:e.length;o>t&&(t=o)}return{maxDecimals:t,unitType:"number"}}}function Ye(r,e){let t=ge(r,e),n=["id","gdp"],o=["of","the","and","in","on"];function s(i){return i.replace(/\S*/g,function(l){return!n.includes(l)&&!o.includes(l)?l.charAt(0).toUpperCase()+l.substr(1).toLowerCase():n.includes(l)?l.toUpperCase():l.toLowerCase()})}return t=s(t.replace(/_/g," ")),t}function at(r,e="object"){const t={};for(const n of Object.keys(r[0])){const o=Ne(r,n),s=o.evidenceType,i=o.evidenceType==="number"?We(r,n):{maxDecimals:0,unitType:o.evidenceType},l=ke(n,o,i);t[n]={title:Ye(n,l),type:s,evidenceColumnType:o,format:l,columnUnitSummary:i}}return e!=="object"?Object.entries(t).map(([n,o])=>({id:n,...o})):t}const ut=Symbol(),ft=Symbol(),ct={}.VITE_BUILD_STRICT==="true";function Ze(r){let e,t,n;return{c(){e=g("br"),t=g("a"),n=A("View environment variables →"),this.h()},l(o){e=k(o,"BR",{}),t=k(o,"A",{class:!0,href:!0});var s=b(t);n=I(s,"View environment variables →"),s.forEach(h),this.h()},h(){d(t,"class","credentials-link svelte-1no0yro"),d(t,"href","https://docs.evidence.dev/cli/#environment-variables")},m(o,s){D(o,e,s),D(o,t,s),y(t,n)},d(o){o&&h(e),o&&h(t)}}}function xe(r){let e,t,n,o,s,i,l,a;function c(_,m){if(_[0]===$e)return Ze}let u=c(r),f=u&&u(r);return{c(){e=g("div"),t=g("div"),n=g("div"),o=A(r[1]),s=z(),i=g("div"),l=A(r[0]),a=z(),f&&f.c(),this.h()},l(_){e=k(_,"DIV",{width:!0,class:!0});var m=b(e);t=k(m,"DIV",{class:!0});var p=b(t);n=k(p,"DIV",{class:!0});var v=b(n);o=I(v,r[1]),v.forEach(h),s=O(p),i=k(p,"DIV",{class:!0});var E=b(i);l=I(E,r[0]),a=O(E),f&&f.l(E),E.forEach(h),p.forEach(h),m.forEach(h),this.h()},h(){d(n,"class","font-bold text-center text-lg"),d(i,"class","text-center [word-wrap:break-work] text-xs"),Z(i,"w-[7.8em]",r[1].includes("Value")),d(t,"class","m-auto w-full"),d(e,"width","100%"),d(e,"class","grid grid-rows-auto box-content grid-cols-1 justify-center bg-red-50 text-grey-700 font-ui font-normal rounded border border-red-200 min-h-[150px] py-5 px-8 my-5 print:break-inside-avoid")},m(_,m){D(_,e,m),y(e,t),y(t,n),y(n,o),y(t,s),y(t,i),y(i,l),y(i,a),f&&f.m(i,null)},p(_,[m]){m&2&&U(o,_[1]),m&1&&U(l,_[0]),u!==(u=c(_))&&(f&&f.d(1),f=u&&u(_),f&&(f.c(),f.m(i,null))),m&2&&Z(i,"w-[7.8em]",_[1].includes("Value"))},i:S,o:S,d(_){_&&h(e),f&&f.d()}}}const $e="SQL Error: Missing database connection; set the EVIDENCE_DATABASE environment variable.";function et(r,e,t){let{error:n}=e,{chartType:o}=e;return r.$$set=s=>{"error"in s&&t(0,n=s.error),"chartType"in s&&t(1,o=s.chartType)},[n,o]}class dt extends B{constructor(e){super(),N(this,e,et,xe,Q,{error:0,chartType:1})}}function _t(r,e,t){var s,i,l,a,c;let n=[];if(r===void 0)throw Error("No dataset provided");if(typeof r!="object")throw Error("'"+r+"' is not a recognized query result. Data should be provided in the format: data = {"+r.replace("data.","")+"}");if(r[0]===void 0||r.length===0)throw Error("Dataset is empty: query ran successfully, but no data was returned from the database");if(((i=(s=r[0])==null?void 0:s.error_object)==null?void 0:i.error)!=null)throw Error("SQL Error: "+((c=(a=(l=r[0])==null?void 0:l.error_object)==null?void 0:a.error)==null?void 0:c.message));if(e!=null){if(!(e instanceof Array))throw Error("reqCols must be passed in as an array");for(var o=0;o<e.length;o++)if(e[o]==null)throw Error("Missing required columns");if(r.__isQueryStore||r instanceof be)for(const f of r.columns)n.push(f.name);else for(const f of Object.keys(r[0]))n.push(f);let u;for(o=0;o<e.length;o++)if(u=e[o],!n.includes(u))throw Error("'"+u+"' is not a column in the dataset");if(t!=null&&t[0]!=null){for(o=0;o<t.length;o++)if(u=t[o],!n.includes(u))throw Error("'"+u+"' is not a column in the dataset")}}}export{it as D,dt as E,st as Q,Re as a,ut as b,_t as c,lt as d,Ye as f,at as g,ft as p,ct as s};
